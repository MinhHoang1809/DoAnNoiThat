<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <input type="text" name="" id="input-item">
    <button id="add-item">Add</button>
    <ul id="todoList">

    </ul>


    <script>
            var toList = [
                    "Go to school",
                    "Do homework",
                    "Playing game"
                ];
            var htmlList = document.getElementById("todoList");
            var addbtn = document.getElementById("add-item");
            addbtn.addEventListener('click', myadd);
            htmlList.addEventListener('click',function(e){
                var button = e.target;
                var i = parseInt(button.dataset.id);
                toList.splice(i,1);
                render();
            });
       
            
            function myadd(){
                var input = document.getElementById("input-item");
                var new_item = input.value;
                toList.push(new_item);
                render();
                input.value = " ";
            }
            function render() {
                var content = toList.map(function (item,i) {
                    return '<li>' + item + ' &nbsp; <button data-id=" ' + i + '"> Delete </button> </li>'  ;
                })
                htmlList.innerHTML = content.join("");
            }
            render();
       
    </script>

<script>
    "use strict";

    var input = document.getElementById('input'), // input/output button
        number = document.querySelectorAll('.numbers>div'), // number buttons
        operator = document.querySelectorAll('.operators>div'), // operator buttons
        result = document.getElementById('result'), // equal button
        clear = document.getElementById('clear'), // clear button
        resultDisplayed =
        false; // flag to keep an eye on what output is displayed : cờ để theo dõi đầu ra nào được hiển thị

    // adding click handlers to number buttons: thêm trình xử lý khi click vào btn-number
    for (var i = 0; i < number.length; i++) {
        number[i].addEventListener("click", function (e) {

            // storing current input string and its last character in variables - used later
            //lưu trữ chuỗi đầu vào hiện tại và ký tự cuối cùng của nó trong các biến - được sử dụng sau này
            var currentString = input.innerHTML;
            var lastChar = currentString[currentString.length - 1];

            // if result is not diplayed, just keep adding
            // nếu kết quả không được hiển thị, chỉ cần tiếp tục thêm
            if (resultDisplayed === false) {
                input.innerHTML += e.target.innerHTML;
            } else if (resultDisplayed === true && lastChar === "+" || lastChar === "-" || lastChar ===
                "×" || lastChar === "÷") {
                // if result is currently displayed and user pressed an operator
                //nếu kết quả hiện được hiển thị và người dùng nhấn một toán tử
                // we need to keep on adding to the string for next operation
                //chúng ta cần tiếp tục thêm vào chuỗi cho hoạt động tiếp theo
                resultDisplayed = false;
                input.innerHTML += e.target.innerHTML;
            } else {
                // if result is currently displayed and user pressed a number
                // nếu kết quả hiện được hiển thị và người dùng nhấn một số
                // we need clear the input string and add the new input to start the new opration
                // chúng ta cần xóa chuỗi đầu vào và thêm đầu vào mới để bắt đầu lựa chọn mới
                resultDisplayed = false;
                input.innerHTML = "";
                input.innerHTML += e.target.innerHTML;
            }

        });
    }

    // adding click handlers to number buttons
    for (var i = 0; i < operator.length; i++) {
        operator[i].addEventListener("click", function (e) {

            // storing current input string and its last character in variables - used later
            //lưu trữ chuỗi đầu vào hiện tại và ký tự cuối cùng của nó trong các biến - được sử dụng sau này

            var currentString = input.innerHTML;
            var lastChar = currentString[currentString.length - 1];
            // if last character entered is an operator, replace it with the currently pressed one
            // nếu ký tự cuối cùng được nhập là một toán tử, hãy thay thế nó bằng ký tự hiện đang được nhấn
            if (lastChar === "+" || lastChar === "-" || lastChar === "×" || lastChar === "÷") {
                var newString = currentString.substring(0, currentString.length - 1) + e.target.innerHTML;
                input.innerHTML = newString;
            } else if (currentString.length == 0) {
                // if first key pressed is an opearator, don't do anything
                // nếu phím đầu tiên được nhấn là một toán tử, đừng làm gì cả
                console.log("enter a number first");
            } else {
                // else just add the operator pressed to the input
                // nếu không, chỉ cần thêm toán tử được nhấn vào đầu vào
                input.innerHTML += e.target.innerHTML;
            }

        });
    }

    // on click of 'equal' button
    result.addEventListener("click", function () {

        // this is the string that we will be processing eg. -10+26+33-56*34/23
        // đây là chuỗi string chúng ta sẽ chạy -10 + 26 + 33 - 56 * 34 / 23
        var inputString = input.innerHTML;

        // forming an array of numbers. eg for above string it will be: numbers = ["10", "26", "33", "56", "34", "23"]
        // tạo thành một mảng số, ví dụ sẽ là.
        var numbers = inputString.split(/\+|\-|\×|\÷/g);

        // forming an array of operators. for above string it will be: operators = ["+", "+", "-", "*", "/"]
        // first we replace all the numbers and dot with empty string and then split
        var operators = inputString.replace(/[0-9]|\./g, "").split("");

        console.log(inputString);
        console.log(operators);
        console.log(numbers);
        console.log("----------------------------");

        // now we are looping through the array and doing one operation at a time.
        // bây giờ chúng ta đang lặp qua mảng và thực hiện một thao tác tại một thời điểm.
        // first divide, then multiply, then subtraction and then addition
        // chia đầu tiên, sau đó nhân, sau đó trừ và sau đó cộng
        // as we move we are alterning the original numbers and operators array
        // khi di chuyển, chúng tôi đang thay đổi các số ban đầu và mảng toán tử
        // the final element remaining in the array will be the output
        // phần tử cuối cùng còn lại trong mảng sẽ là đầu ra

        var divide = operators.indexOf("÷");
        while (divide != -1) {
            numbers.splice(divide, 2, numbers[divide] / numbers[divide + 1]);
            operators.splice(divide, 1);
            divide = operators.indexOf("÷");
        }

        var multiply = operators.indexOf("×");
        while (multiply != -1) {
            numbers.splice(multiply, 2, numbers[multiply] * numbers[multiply + 1]);
            operators.splice(multiply, 1);
            multiply = operators.indexOf("×");
        }

        var subtract = operators.indexOf("-");
        while (subtract != -1) {
            numbers.splice(subtract, 2, numbers[subtract] - numbers[subtract + 1]);
            operators.splice(subtract, 1);
            subtract = operators.indexOf("-");
        }

        var add = operators.indexOf("+");
        while (add != -1) {
            // using parseFloat is necessary, otherwise it will result in string concatenation :)
            numbers.splice(add, 2, parseFloat(numbers[add]) + parseFloat(numbers[add + 1]));
            operators.splice(add, 1);
            add = operators.indexOf("+");
        }

        input.innerHTML = numbers[0]; // displaying the output

        resultDisplayed = true; // turning flag if result is displayed
    });

    // clearing the input on press of clear
    clear.addEventListener("click", function () {
        input.innerHTML = "";
    })
</script>
</body>

</html>